\documentclass[12pt]{book}

\usepackage[dvips,letterpaper,margin=0.75in,bottom=0.5in]{geometry}
\usepackage{cite}
\usepackage{slashed}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{braket}
\begin{document}

\newcommand{\ihbar}{\ensuremath{i \hbar}}
\newcommand{\Pss}{\ensuremath{\Psi^*}}
\newcommand{\dPsidt}{\ensuremath{ \frac{\partial \Psi}{\partial t} }}
\newcommand{\dPsidx}{\ensuremath{ \frac{\partial \Psi}{\partial x} }}
\newcommand{\ddPsidx}{\ensuremath{ \frac{\partial^2 \Psi}{\partial x^2} }}
\newcommand{\dPssdt}{\ensuremath{ \frac{\partial \Psi^*}{\partial t} }}
\newcommand{\dPssdx}{\ensuremath{ \frac{\partial \Psi^*}{\partial x} }}
\newcommand{\ddPssdx}{\ensuremath{ \frac{\partial^2 \Psi^*}{\partial x^2} }}

\newcommand{\dphidt}{\ensuremath{ \frac{d \phi}{dt} }}
\newcommand{\dpsidx}{\ensuremath{ \frac{d \psi}{dx} }}
\newcommand{\ddpsidx}{\ensuremath{ \frac{d^2 \psi}{dx^2} }}


\title{PHY 115L \\
Numerical Approaches to the \\
Harmonic Oscillator \\ 
(Theory:  Griffith's Section 2.3)}
\author{Michael Mulhearn}

\maketitle

\setcounter{chapter}{1}
\chapter{Time-Independent Schr\"odinger Equation}

\section{Stationary States}

Here's our summary of Griffiths section 2.1:

We attempt to solve the Schr\"odinger Equation:
\begin{equation}
\ihbar \, \dPsidt \; = \; - \frac{\hbar^2}{2 m} \; \ddPsidx \, + \, V \, \Psi
\end{equation}
in the case that the potential V(x) is not a function of $t$.  We will try to find a solution under the assumption that $\Psi(x,t)$ is separable:
\begin{equation}
\Psi(x,t) \; = \; \psi(x) \,\phi(t)
\end{equation}
which yields:
\begin{eqnarray*}
\ihbar \, \psi \dphidt \; &=& \; - \frac{\hbar^2}{2 m} \; \phi \ddpsidx \, + \, V \, \Psi\\
\ihbar \, \frac{1}{\phi(t)} \dphidt \; &=& \; - \frac{\hbar^2}{2 m} \; \frac{1}{\psi(x)}\ddpsidx \, + \, V(x)\\
\end{eqnarray*}
As the LHS is a function of $t$ only, and the RHS a function of $x$ only, both sides must be constant wrt $t$ and $x$ respectively.  We'll call that constant $E$, and solve for $\phi(t)$:
\begin{eqnarray*}
\ihbar \, \frac{1}{\phi(t)} \dphidt \; &=& E\\
\int \frac{d\phi}{\phi(t)}  \; &=& -\frac{iE}{\hbar} \int dt\\
\ln \phi &=& -\frac{iEt}{\hbar}\\
\phi(t) &=& \exp(-\frac{iEt}{\hbar})\\
\end{eqnarray*}
The remaining equation is for $\psi(x)$ only
\begin{equation}
- \frac{\hbar^2}{2 m} \; \ddpsidx \, + \, V(x) \, \psi(x) = E \, \psi(x)\\
\end{equation}
and is called the Time-Independent Schr\"odinger Equation (TISE), but often just called the Schr\"odinger Equation when the meaning is clear.

In classical mechanics, the total energy (kinetic plus potential) is called the Hamiltonian:
\begin{equation*}
H(x,p) = \frac{p^2}{2m} + V(x)
\end{equation*}
We can construct the corresponding operator in quantum mechanics by substituting 
\begin{eqnarray*}
x &\to& \hat{x} = x \\
p &\to& \hat{p} = -i\hbar \frac{\partial}{\partial x} \\
\end{eqnarray*}
to calculate:
\begin{equation}
\hat{H} = H(\hat{x}, \hat{p})= -\frac{\hbar^2}{2m}\,\frac{\partial^2}{\partial x^2} + V(x)
\end{equation}
with which we can write the TISE as:
\begin{equation}
\label{eqn:htise}
\hat{H} \, \psi(x) = E \, \psi(x)
\end{equation}
We say that separable solutions are eigenstates of the Hamiltonian operator.  (This is analogous to an eigenvector problem in linear algebra.)

We'll demonstrate later the following boundary conditions on $\psi(x)$:
\begin{itemize}
\item $\psi(x)$ is always continuous.
\item $d\psi/dx$ is continuous except where the potential is infinite.
\end{itemize}
Note that these conditions do not apply to $\Psi(x,t)$ which need not be continuous.

Some further observations left as exercises (See Griffith's problems 2.1 and 2.2)
\begin{itemize}
\item For normalizable solutions, the separation constant $E$ must be real.
\item $\psi(x)$ can always be taken as a real function.
\item If $V(x)$ is an even function, then the general solutions $\psi(x)$ can be constructed as either even or odd solutions.
\item For normalizable solutions, $E$ must be greater than the minimum value of $V(x)$.
\end{itemize}
\noindent
The separable solutions are important solutions because:
\begin{itemize}
\item They represent {\bf stationary states}:  even though the ``full'' wave function
\begin{equation*}
\Psi(x,t) = \phi(t) \, \psi(x) = e^{-iEt/h} \, \psi(x)
\end{equation*}
has a time dependence, the probability density is constant with time:
\begin{eqnarray*}
|\Psi(x,t)|^2 &=& \left(e^{-iEt/h} \, \psi(x)\right)^* \; \left(e^{-iEt/h} \, \psi(x)\right)\\[8pt]
&=& e^{iEt/h-iEt/h} \, \psi^*(x) \psi(x)\\[8pt]
&=& | \psi(x) |^2
\end{eqnarray*}
This means that every expectation value is constant wrt time as well.  It also follows that:
\begin{equation*}
\int_{-\infty}^{+\infty}\, |\psi(x)|^2 dx = 1\\
\end{equation*}
\item They represent {\bf states of definite total energy:} the expectation value for the total energy of a separable solution is:
\begin{eqnarray*}
\braket{E} &=& \int_{-\infty}^{+\infty}\, \Psi^*(x,t) \, \hat{H} \, \Psi(x,t) \; dx \\[8pt]
           &=& \int_{-\infty}^{+\infty}\, \psi^*(x) \, \hat{H} \, \psi(x) \; dx \\[8pt]
           &=& \int_{-\infty}^{+\infty}\, \psi^*(x) \, E \, \psi(x) \; dx \\[8pt]
           &=& E \int_{-\infty}^{+\infty}\, |\psi(x)| \; dx \\[8pt]
           &=& E           
\end{eqnarray*}
Remember that we just chose $E$ as the symbol for the constant value when using separation of variables.  This shows why we choose $E$, as that constant is the expectation value of the total energy.  Now calculate in a similar fashion:
\begin{eqnarray*}
\braket{E^2} &=& \int_{-\infty}^{+\infty}\, \Psi^*(x) \, \hat{H}^2 \, \Psi(x) \; dx \\[8pt]
           &=& E^2
\end{eqnarray*}
From which it follows:
\begin{equation*}
\sigma^2_H = \braket{E^2} - \braket{E}^2 = E^2 - E^2 = 0
\end{equation*}
This means that every measurement of the particles total energy will yield the result $E$.
\item There is more, but (unlike Griffiths) we will leave those features for later.
\end{itemize}

\section{The Harmonic Oscillator}

The classical harmonic oscillator is a mass $m$ connected to a spring which follows Hooke's law:
\begin{equation*}
F = -k \, x = m \frac{d^2x}{dt^2} 
\end{equation*}
with oscillatory solutions
\begin{equation*}
x(t) = A \cos(\omega t) + B \sin(\omega t)
\end{equation*}
where:
\begin{equation*}
\omega = \sqrt{\frac{k}{m}}
\end{equation*}
The potential energy is
\begin{equation*}
V(x) = \frac{1}{2}k x^2 = \frac{1}{2} m \omega^2 x^2
\end{equation*}
The classical harmonic oscillator is {\em widely} applicable, at least as an approximation, because any potential is approximately a parabola near a local minimum in the potential:
\begin{eqnarray*}
V(x) &=& V(x_0) + V'(x_0) \, (x-x_0) + \frac{1}{2}\,V''(x_0) \, (x-x_0)^2 + \ldots \\[5pt]
V(x) &=& V_0 + \frac{1}{2}\,V''(x_0) \, (x-x_0)^2 + \ldots \\[5pt]
V(x) &\approx& -\frac{1}{2}\,V''(x_0)\\
\end{eqnarray*}
where we have used the fact that $V'(x_0)=0$ at the minimum and the constant offset $V_0$ can be taken as zero.

In this section, we will turn our attention to the widely applicable quantum harmonic oscillator, and find the solutions to the TISE for:
\begin{equation*}
\hat{H} = -\frac{\hbar^2}{2m}\,\frac{\partial^2}{\partial x^2} + \frac{1}{2} m \omega^2 x^2
\end{equation*}
We are first going to solve this the hard way, through the power series solution, and then solve it using an elegant algebraic method.

\subsection{Power Series Solutions}

We are solving this equation:
\begin{equation*}
-\frac{\hbar^2}{2m}\,\frac{d^2 \psi}{d x^2} + \frac{1}{2} m \omega^2 x^2 \psi(x) = E \psi(x)
\end{equation*}
but if we leave it in that form we will spend all our time dealing with constants and not make any progress.  Instead our idea is two multiply through by:
$$\frac{2}{\hbar \omega}$$
as this will make the coefficient of the RHS dimensionless, and get rid of the factors of $1/2$ on the LHS.  This gives us:
\begin{equation*}
-\frac{\hbar}{m\omega}\,\frac{d^2 \psi}{d x^2} + \frac{m \omega}{\hbar} x^2 \psi(x) = \frac{2E}{\hbar\omega} \psi(x)
\end{equation*}
and we can see the progress we've made if we put:
$$x_0 \equiv \sqrt{\frac{\hbar}{m \omega}}$$ 
and 
$$\epsilon \equiv \frac{2E}{\hbar\omega} $$
Our equation becomes:
\begin{equation*}
-x_0^2 \; \frac{d^2 \psi}{d x^2} \, + \, \frac{x^2}{x_0^2} \, \psi(x) \; = \; \epsilon \, \psi(x)
\end{equation*}
which is already looking less tedious.  But note that we can define a dimensionless variable $u$ to replace $x$ as:
$$u \equiv \frac{x}{x_0}$$
and noting that:
$$\frac{d}{dx} = \frac{du}{dx}\frac{d}{du} = a \frac{d}{du}$$
we have at last:
\begin{equation*}
-\frac{d^2 \psi}{d u^2} \, + \, u^2 \, \psi(u) \; = \; \epsilon \, \psi(x)
\end{equation*}
or:
\begin{equation*}
\frac{d^2 \psi}{d u^2} \; =  \; (u^2 - \epsilon) \, \psi(u) 
\end{equation*}
the same equation with the tedious constants hidden in our variable definitions.

Next we consider the behavior of $\psi$ at large $u$ (which is also large $x$).  In this case, the differential equation becomes:
\begin{equation*}
\frac{d^2 \psi}{d u^2}  \approx u^2 \psi(u) 
\end{equation*}
Noticing that the derivatives cause the power of $u$ to increase leads us to try something like:
\begin{equation*}
\psi(u) = \exp\left(\frac{\alpha u^2}{2}\right)
\end{equation*}
for some $\alpha$, because each derivative will bring down a factor of $u$.  But as we'll see, even something like:
\begin{equation*}
\psi(u) = u^k \; \exp\left(\frac{\alpha u^2}{2}\right)
\end{equation*}
will do the trick.  Trying it out:
$$\frac{d \psi}{d u}  = \left(\alpha u^{k+1} + k\,u^{k-1}\right) \, \exp\left(\frac{\alpha u^2}{2}\right) $$
and
$$\frac{d^2 \psi}{d u^2}  = \alpha^2 u^{k+2} \exp\left(\frac{\alpha u^2}{2}\right) \, \left(1 + \mathcal{O}(1/u^2)\right)$$
where the symbol $\mathcal{O}(1/u^2)$ means terms of order $1/u^2$ and smaller.  Because $u$ is large, we can neglect these higher order terms relative to the leading 1, and get:
$$\frac{d^2 \psi}{d u^2}  = \alpha^2 u^2 \psi$$
which satisfies the differential equation if $\alpha^2 = 1$, i.e.:
$$\psi(u) = A u^k \exp(-u^2/2) + B u^k \exp(+u^2/2)$$
but we cannot hope to normalize the wave function unless the $B$ term is zero.  So we conclude that the limiting behavior of the wave function we want is:
$$\psi(u) = A u^k \exp(-u^2/2)$$
This leads us to try a solution of the form:
$$\psi(u) = h(u) \exp(-u^2/2)$$
where $h(u)$ is any function of $u$.  Note that we are no longer making any approximation.  We can express any wave function this way.  We are just hopeful the differential equation for $h(u)$ will be easier to solve than the differential equation for $\psi(u)$, because the asymptotic behavior has been factored out.  Trying it out:
$$\frac{d\psi}{du} = \left( \frac{dh}{du} - u\, h(u)\right) \, e^{-u^2/2}$$
and
$$\frac{d^2\psi}{du^2} = \left( \frac{d^2h}{du^2} - 2 u \frac{dh}{du} + (u^2-1)h(u) \right) \, e^{-u^2/2}$$
the TISE becomes:
\begin{eqnarray*}
\left( \frac{d^2h}{du^2} - 2 u \frac{dh}{du} + (u^2-1)h(u) \right) \, e^{-u^2/2} &=& (u^2-\epsilon)\\[7pt] 
\left( \frac{d^2h}{du^2} - 2 u \frac{dh}{du} + (\epsilon-1)h(u) \right) \, e^{-u^2/2} &=& 0\\
\end{eqnarray*}
but $e^{-u^2/2}$ is nowhere zero, so we are left with the TISE for $h(u)$ as:
\begin{equation}
\label{eqn:htise}
\frac{d^2h}{du^2} - 2 u \frac{dh}{du} + (\epsilon-1)h(u) = 0
\end{equation}
We will solve it with everyones least favorite method: power series.  We assume:
$$h(u) = \sum_{m=0}^{\infty} a_m u^m$$
then calculate:
$$\frac{dh}{du} = \sum_{m=0}^{\infty} m a_m u^{m-1}$$
and
$$\frac{d^2h}{du^2} = \sum_{m=0}^{\infty} m (m-1) a_m u^{m-2}$$
Then we start collecting terms from the LHS of the Equation~\ref{eqn:htise}:
$$(\epsilon-1)\;h(u) = \sum_{m=0}^{\infty} (\epsilon-1)\;a_m u^m$$
and:
$$-2 u \, \frac{dh}{du} = \sum_{m=0}^{\infty} -2 \, m \, a_m \, u^{m}$$
which to our good fortune have the same power of $u$ for each value of $m$.  But that is not the case for the second derivative, which we will reproduce here as:
$$\frac{d^2h}{du^2} = \sum_{n=2}^{\infty} n (n-1) a_n u^{n-2}$$
with the index in the sum changed to $n$ (for simplicity below) and where the first two terms have been omitted from the sum as they are both zero.  To line up nicely with the first two series, we need to have the term $m$ be a power $u^m$ so substituting $m = n - 2$ we get:
$$\frac{d^2h}{du^2} = \sum_{m=0}^{\infty} (m+2) (m+1) a_{m+2} u^{m}$$
and the TISE for $h(u)$ becomes:
$$\sum_{m=0}^{\infty} \left[(\epsilon-1)\;a_m -2 \, m \, a_m + (m+2) (m+1) a_{m+2} \right] u^{m} = 0$$
to be zero everywhere, the coefficients of every power of $u$ must vanish, leading to:
$$(\epsilon-1)\;a_m -2 \, m \, a_m + (m+2) (m+1) a_{m+2} = 0$$
which can be written as the recursion relationship:
\begin{equation}
\label{eqn:hermrec}
a_{m+2} = \frac{2m+1-\epsilon}{(m+2)(m+1)} \; a_m
\end{equation}
which appears on a first glance to solve the problem.  This recursion relation will give all the even $a_m$ starting from $a_0$ and all the odd $a_m$ starting from $a_1$. Noting that:
$$h(0) = a_0$$
and 
$$h'(0) = a_1$$
it seems that given two initial conditions, we obtain the corresponding solution $h(u)$ as a series.  
We can break this solution into two solutions, an even solution and an odd solution:
$$h(u) = h_{\rm even}(u) + h_{\rm odd}$$
with:
$$h_{\rm even}(u) = a_0 + a_2 \, u^2 + a_4 \, u^4 + \ldots$$
and 
$$h_{\rm odd}(u) = a_1 \, u + a_3 \, u^3 + a_5 \, u^5 + \ldots$$

But on a closer look, it seems we are in deep trouble for two reason.  First, we expected (as in the infinite square well) to find that we had solutions only for certain values of the energy ($epsilon$ here) but these recursion relations give a solution for any value of $\epsilon$.  Secondly, for large $m$ the recursion relationship becomes:
$$a_{m+2} \approx \frac{2}{j}\;a_{m}$$
which looks like {\bf bad news}.  Let's start with $h_{\rm even}(u)$.  Picking some large even number $2n$ and defining (you see why shortly):
$$C \equiv a_{2n} n!$$
we have:
$$a_{2(n+1)} \approx \frac{1}{n}\;a_{2n} \approx \frac{1}{n+1}\;a_{2n} = \frac{C}{(n+1)!}$$
and it keeps going:
$$a_{2(n+2)} \approx \frac{C}{(n+2)!}$$
So the asymptotic behavior of $h_{\rm even}$ is:
$$h_{\rm even}(u) \approx \sum_{n=0}^{\infty} \frac{C}{n!}u^{2n} = C\exp(u^2)$$
and so:
$$\psi(u) \approx h_{\rm even}(u) \exp(-u^2/2) \approx C \exp(u^2/2)$$
which we cannot possibly normalize.  In fact, this is {\bf exactly} the unusable solution to the TISE at large $u$ that we threw away, coming back to us.
You might hope that $h_{\rm odd}(u)$ can save the day, but we can pick a large odd number $2n+1$ and proceed in exact same manner to find that $h_{\rm odd}(u)$

There is only one way out of this predicament.  The series must terminate at some coefficient $a_n$.
Looking back at Equation~\ref{eqn:hermrec} we see that if:
$$2n+1-\epsilon = 0$$
then $a_{n+2} = 0$.  Recalling our definition for $\epsilon$ we see that:
\begin{equation}
E = \hbar \omega \left( n + \frac{1}{2} \right)
\end{equation}
The highest power term in the series defining $h(u)$ will be $u^n$, with the asymptotic before of $\psi(u)$ now:
$$\psi(u) \; \approx \; h(u) \, \exp(-u^2/2) \; \approx \; C \, u^n \, \exp(-u^2/2) \, dx $$
this is precisely the nice behavior we choose at the very start.

We can work out explicit solutions.  It's convenient to rewrite the recursion formula in terms of the quantum number $n$ instead of $\epsilon = 2n+1$:
\begin{equation}
a_{m+2} = \frac{-2(n-m)}{(m+2)(m+1)} \; a_m
\end{equation}
For $n=0$, the last term is $a_0$, so we have simply
$h_0(u) = a_0$ and so
$$\psi_0(u) = a_0 e^{-u^2/2}$$
For $n=1$, the last term is $a_1$, and so $h_1=a_1 u$ and
$$\psi_1(u) = a_1 u e^{-u^2/2} $$
For $n=2$, the last term is $a_2$, with $a_2 = -2a_0$ and so
and so $h_2=a_0 \, (1-2u^2)$ and
$$\psi_2(u) =  a_0 \, (1-2u^2) \, e^{-u^2/2} $$

The polynomials are know as the Hermite polynomials $H_n(u)$.  They can be most ``easily'' obtained from the Taylor expansion of the generating function:
$$\exp(-z^2+2zu) = \sum_{n=0}^{\infty} \frac{z_n}{n!}H_n(u)$$
with this convention, the normalized stationary states for the harmonic oscillator are:
$$\psi_n(x) = \left( \frac{m \omega}{\pi \hbar} \right)^{1/4} \frac{1}{\sqrt{2^n n!}}H_n(u) e^{-u^2/2}$$
where
$$u \equiv \sqrt{\frac{m \omega}{\hbar}} x$$.

\section{Homework Problems}

\noindent
{\bf Problem 1:} Write a program to determine the coefficients of the Hermite polynomial $H_n(\epsilon)$ for any degree $n$ by using the recursion formula from
the power series solution.  Remember to apply the normalization
condition for each $H_n(\epsilon)$ that the coefficient of
$\epsilon^n$ is $2^n$.  Print the non-zero coeffients for $n=0$ to $5$ and
compare to e.g. Griffith's Table 2.1\\[5pt]

\noindent
{\bf Problem 2:} Write a program to determine the coefficients of the Hermite polynomial $H_n(\epsilon)$ for any degree $n$ by using the generating function:
$$\exp(-z^2+2zu) = \sum_{n=0}^{\infty} \frac{z_n}{n!}H_n(u)$$
Print the non-zero coeffients for $n=0$ to $5$ and
compre to e.g. Griffith's Table 2.1\\[5pt]


\noindent
{\bf Problem 3:} (A) Write a program to calculate the Hermite polynomial
$H_n(\epsilon)$ for a particular value $\epsilon$ and for any degree
$n$ by using the recursion formula:
$$H_{n+1}(\epsilon) = 2 \epsilon H_n(\epsilon) - 2 n H_{n-1}(\epsilon)$$.\\

\noindent
(B) Test your function {\bf thoroughly} against the Python library results
(scipy.special.hermite) using randomly chosen values.  That is, pick a
random integer $n$ from $0$ to some reasonable maximum test value $N$, then
pick a randomly choosen $\epsilon$ value from some reasonably range,
and compare the results of your program with that of the python library.  You
want to do this many many times, so you'll have to figure out a way to
handle the fact the agreement will not be pefect and yet still say
something definitive.\\[5pt]

\noindent
{\bf Problem 5:} Plot the wave function $\psi_n(x)$ and
$|\psi_n(x)|^2$ for $n=0,1,2,3$.  You are aiming to reproduce Fig
2.7(a) in Griffith's.  (Let me know if you don't have access to this textbook
and I will include photocopies of the needed figures on the course
site.)  Remember that $\psi_n(x)$ is not just the Hermite polynomical!
You may use the python library for the Hermite polynomials.\\[5pt]

\noindent
{\bf Problem 6:} Numerically verify that the $\psi_n(x)$ are
orthonormal.  Keep to $n<10$.  (Depending on your approach, you won't
get exactly 1 and 0 so you will need some way to handle this and still
give a definitive answer...there are many valid approaches)\\[5pt]

\end{document}
